
<div class="d-flex align-items-center page_header">
    <div class="page_title  min-wleftheader">
        <h4><b>User Assignment</b></h4>
    </div> 
  </div>
  <kendo-grid [kendoGridBinding]="gridData" [pageable]="true" [pageSize]="10" [sortable]="true" [groupable]="true"
    (dataStateChange)="onStateChange($event)" (add)="addHandler($event)" (edit)="editHandler($event)"
    (cancel)="cancelHandler($event)" (save)="saveHandler($event)" (remove)="removeHandler($event)" [navigable]="true">
    <ng-template kendoGridToolbarTemplate>
      <button kendoGridPDFCommand icon="file-pdf">Export to PDF</button>
      <button type="button" kendoGridExcelCommand icon="file-excel">Export to Excel</button>
      <button kendoGridAddCommand>Add new</button>
    </ng-template>
  
    <kendo-grid-column field="strUserName" editor="text" title="User Name">
      <ng-template kendoGridEditTemplate>
        <kendo-dropdownlist 
        [data]="AdminList" 
        [value]="selectedAdmin" 
        [defaultItem]="defaultAdmin"
        textField="strUserName" 
        valueField="intUserID')" 
        (valueChange)="handleAdminChange($event)">
        </kendo-dropdownlist>
      </ng-template>


    </kendo-grid-column>
    
    <kendo-grid-column field="strAreaNames" editor="text" title="Area Name">

        <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
            <kendo-multiselect
              [data]="dataArea"
              [(ngModel)]="selectedAreas"  
              textField="AreaName"
              valueField="AreaID"
              (valueChange)="handleAreaChange($event)"
            ></kendo-multiselect>
            <!-- {{ category(dataItem.intParkingLotID)?.strParkingLotName }} -->
          </ng-template>
  

    </kendo-grid-column>
  
    <kendo-grid-column field="strParkingLotNames" editor="text" title="Lot Name">

        <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
            <kendo-multiselect
              [data]="dataResultLot"
              [(ngModel)]="selectedLots"  
              textField="LotName"
              valueField="LotID"
            ></kendo-multiselect>
            <!-- {{ category(dataItem.intParkingLotID)?.strParkingLotName }} -->
          </ng-template>
  
    </kendo-grid-column>
    
  
  
    <kendo-grid-excel fileName="User Assignment.xlsx">
  
      <!-- <kendo-excelexport-column field="strPISDeviceID" editor="text" title="PIS Device"></kendo-excelexport-column> -->
      <kendo-excelexport-column field="strUserName" editor="text" title="User Name"></kendo-excelexport-column>
    
      <kendo-excelexport-column field="strAreaNames" editor="text" title="Area Name">
        <ng-template kendoGridEditTemplate>
          <kendo-dropdownlist [data]="dataArea" [value]="selectedArea" [defaultItem]="defaultArea" textField="AreaName"
            valueField="AreaID" (valueChange)="handleAreaChange($event)">
          </kendo-dropdownlist>
        </ng-template>
      </kendo-excelexport-column>
    
      <kendo-excelexport-column field="strParkingLotNames" editor="text" title="Lot Name">
        
      </kendo-excelexport-column>
      
     
    </kendo-grid-excel>



    <kendo-grid-pdf fileName="User Assignment.pdf" [allPages]="true" paperSize="A4" [repeatHeaders]="true" [landscape]="true">
    <kendo-grid-column field="strUserName" editor="numeric" title="User Name"></kendo-grid-column>
    
    <kendo-grid-column field="strAreaNames" editor="text" title="Area Name">
      <ng-template kendoGridEditTemplate>
        <kendo-dropdownlist [data]="dataArea" [value]="selectedArea" [defaultItem]="defaultArea" textField="AreaName"
          valueField="AreaID" (valueChange)="handleAreaChange($event)">
        </kendo-dropdownlist>
      </ng-template>
    </kendo-grid-column>
  
    <kendo-grid-column field="strParkingLotNames" editor="text" title="Lot Name">
  
  
    </kendo-grid-column>
    
     
      <kendo-grid-pdf-margin top="2cm" left="1cm" right="1cm" bottom="2cm"></kendo-grid-pdf-margin>
      <ng-template kendoGridPDFTemplate let-pageNum="pageNum" let-totalPages="totalPages">
        <div class="page-template">
          <div class="header">
            <div style="float: right">Page {{ pageNum }} of {{ totalPages }}</div>
  
          </div>
  
        </div>
      </ng-template>
    </kendo-grid-pdf>
  
  
    <kendo-grid-command-column title="command" [width]="220">
      <ng-template kendoGridCellTemplate let-isNew="isNew">
        <button kendoGridEditCommand [primary]="true">Edit</button>
        <button kendoGridRemoveCommand>Remove</button>
        <!-- <button kendoGridSaveCommand [disabled]="formGroup?.invalid">{{ isNew ? 'Add' : 'Update' }}</button> -->
        <button kendoGridSaveCommand>{{ isNew ? 'Add' : 'Update' }}</button>
        <button kendoGridCancelCommand>{{ isNew ? 'Discard changes' : 'Cancel' }}</button>
      </ng-template>
    </kendo-grid-command-column>
  
  
  </kendo-grid>